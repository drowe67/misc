\documentclass{article}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{siunitx}
\usepackage{array}
\begin{document}

\title{Urban EMI on Lower HF}
\author{David Rowe VK5DGR}

\maketitle

\section{Introduction}
 
Throughout the 20th century HF radio receiver technology evolved with the aim of detecting distant, narrow band signals.  Radio noise sets the limits of detection, and was assumed to be from natural sources or the receiver itself.  However in the early 21st century, noise from human activity now dominates the detection problem.  We are no longer seeking to maximise signal-to-noise ratio (SNR), but signal to EMI ratio (SER).

We are slowly losing the ability to use analog SSB in urban areas.  Many Hams report S9 noise levels, $9 \times 6 = 54$ dB higher than a quiet S0 country station.  Consequently, digital modes that can operate operate at low SNRs are becoming popular.

Our target radio signals are from distant sources, weak, narrow band, and evolve slowly in time. Human generated radio noise tends to be very strong, wideband, with a time domain envelope that evolves quickly in time.  It is often radiated from nearby sources, such as power lines lines and house wiring a few meters from our antenna.  Some EMI has significant structure, so can be interpreted as an interfering signal, rather than random noise.

There are a lot of on-line opinions, hearsay, rules of thumb, and subjective reports on this topic.  I have found this topic to be very complex, with many inter-related variables. Everyone else seems to work DX ok. I often wondered if my site was the exception - is it just my house or suburb?  

This report was written to further my understanding of the topic, and hopefully improve conditions at my home station. No claim of any original work is made.

\subsection{Summary}

What I've learnt about characterising and removing noise:
\begin{enumerate}
\item S-meters can't be trusted \cite{vu2nsb_s_meter}\cite{dj0ip_s_meter}, you'll need a calibrated way to measure noise power at your site.
\item Measure your ambient noise figure $F_a$ and compare to P.372 \cite{itu372-16}.
\item If your noise is AWGN and your $F_a$ is similar to P.372 it's probably city wide noise, rather than something local. Congratulations you are doing as well as can be reasonably expected. Your options are a (receive) antenna with directivity, or moving your antenna to the country.
\item If you see harmonics on your waterfall (and hear tones as your tune across the band) it's PWM and likely very local.
\item If it's rapid clicks or buzzing it's impulse noise which is also local, but can travel down power lines around suburbs. 
\item To address PWM and impulse local noise, position your antenna at least 6m from any buildings, power and phone lines.  Look for and address any common modem feedline issues, use a balun on your dipole, or use antennas with good balance (like loops).  Try Diversity.  Your noise blanker might work for impulse noise.  A small loop antenna might help as it is easier to place away from noise sources than a wire antenna.
\item If possible, find and remove the local noise sources.
\end{enumerate}

Table \ref{table:noise_classes} is how I classify noise.  Like many taxonomies, the boundaries are not clear cut.  For example if you have enough PWM or impulse sources added together you get AWGN.  A single impulse can be considered a PWM signal with a very low frequency.  I found it useful to classify periodic noise sources based on if the noise pulse rate $R$ is inside or outside the receiver bandwidth $B$.
\begin{table}[h]
\centering
\begin{tabular}{ | m{1.2cm} | m{4cm} | m{3cm} | m{2cm} |}
 \hline\hline
 Name & Characteristics & Example & Sound \\
 \hline
 AWGN & Constant in time and frequency & Natural noise, or sum of many sources & Ssshhh \\
 \hline
 Impulse & Short pulses far apart in time $R<B$, wideband in frequency & Power lines, Ignition & clicks or buzzing \\
\hline PWM & Short pulses close together in time $R>B$, harmonics in frequency & Switch mode power supplies & tones or hash \\
 \hline
\end{tabular}
\caption{How I classify noise signals. AWGN is Additive White Gaussian Noise, PWM is Pulse Width Modulation, $R$ is the frequency of the noise pulses, $B$ is your receiver bandwidth.}
\label{table:noise_classes}
\end{table}

The maths and analysis of experimental data has these take aways:
\begin{enumerate}
\item Both the noise and noise blankers can be expressed as a Fourier series.
\item PWM harmonics are PSK signals, AM modulated onto carriers at the centre of each harmonic.  By thinking of the noise as signals with structure we can get insight into possible attacks.
\item PWM noise is localised to harmonic centres at lower frequencies, then gets wider with increasing frequency.
\item The signal processing bandwidth where the blanker runs matters \cite{sm5bsz_blanker}.  As the bandwidth is reduced the noise pulses are smeared together.
\item Blankers don't attenuate the wanted signal much, but do introduce intermodulation.  Blankers are likely to be more effective with digital than analog modes.
\item A blanker running in a wide bandwidth may be useful for reducing the impact of PWM noise.
\item Diversity only works when the noise is effectively a point source.
\item In an urban location, your ability to establish a link may be limited by the ambient noise your receiver detects more than than your transmitter EIRP.  Consider combining a low gain receive antenna with directivity (e.g. an array of small antennas) with a simple transmit antenna such as a dipole.
\item Impulse noise can be really complex, confusing narrow band noise blankers.
\item Impulses make the antenna system ring. It may be possible to identify and remove this ringing.
\item A limiter and detector running in a wide processing bandwidth might be useful for digital modes.
\end{enumerate}

\subsection{Selected References}

This field is highly subjective, with many claims not backed by sound signal processing or antenna theory. I have found it difficult to find hard data, repeatable experiments and good quality references.

References I recommend are ITUT-R P372 \cite{itu372-16}, the W8JI web site \cite{w8ji_radio_noise} for a concise overview of HF noise and small loop antenna myths; and the web site of LZ1AQ \cite{lz1aq} for his studies on small loop antenna arrays. After some experimentation \cite{rowetel_noise_city} I've settled on the approach suggested by Owen Duffy \cite{duffy_lig} and Basu \cite{vu2nsb_s_meter} - comparing my ambient noise floor to P.372 to check my baseline, then seeing what I can do about local noise sources. John Fallows VE6EY \cite{ve6ey} has some fine material on noise reduction using diversity receivers on his blog and YouTube channel.

\section{Radio Noise Signals from Human Activity}

Table \ref{table:human_noise} is a summary of human generated noise sources.  The values are approximate and based on my experience - your mileage may vary!  This categorisation gives us some insight that can be used to classify signals, consider their impact, and possible attacks.

The Time and Frequency columns describe the distribution of energy in time and frequency, for example power line arcing can cause clicks similar to atmospheric lightning.  The noise signal consists of short, powerful time domain pulses that are randomly distributed in time, resulting in wideband energy uniformly distributed in frequency. It may be identified and removed via noise blanking techniques.

In contrast DSL signals radiated from leaky phone lines looks like noise in the time domain and frequency domain, making it particularity hard to identify and remove.  It is very similar to AWGN from natural noise sources.

Bandwidth relates the rate $R$ of the noise pulses to the bandwidth $B$ of a typical SSB HF receiver (around 2000 Hz).  When $R<<B$, we tend to hear individual noise pulses, and separate pulses can be observed in a time domain plot of the receiver output waveform.  When $R>B$, we hear just a bandpass segment of the EMI signal, for example a tone from a PWM harmonic, or some modulated noise.

Our narrow band receiver smooths the time domain envelope of noise impulses. As $R$ relative to $B$ increase, our receiver smears the short time domain pulses (such as a PWM waveform) into a longer pulses with a smoother time domain envelope (such as damped sinusoids and in the limiting case AWGN noise), making the EMI signal harder to identify and remove.

For EMI signals to be detected by our receiver, we need a source of RF currents and a way of coupling those current into our antenna system (which includes the antenna and feed line).  On lower HF our antenna systems are typically located less than one wavelength from the source of RF currents so both near and far field coupling is possible.

If we position our receiver some distance from many noise signals, we get the sum of many signals added together, which converges to far field AWGN noise.  The level reduces with distance, so an effective attack is travelling to a country location, and operating a portable station for the day.

Domestic electricity lines appear to operate in a mode part way between transmission line and antenna.  RF does seem to propagate along them quite well, they then couple quite well into nearby antennas.  Likewise, DSL signals on ancient phone lines are poor transmission lines and reasonably effective antennas, radiating significant local EMI. A home with buried electricity lines and fibre or wireless supplying Internet is an effective attack on these sources.

\begin{table}[h]
\centering
\begin{tabular}{l l l l l l}
 \hline
 Name & Rate & Time & Frequency & Antenna & BW \\
 \hline
 Power Line & 1 Hz & random pulse & uniform & power lines & $R < B$ \\
 Downlights & 50-60 Hz & pulse train & harmonics & house wiring & $R < B$ \\
 SMPS & 10-300 kHz & pulse train & harmonics & house wiring & $R > B$ \\
 DSL & 1-12 MHz & AWGN & AWGN & phone lines & $R > B$ \\
 Urban Sum & lower HF & AWGN & AWGN & power lines & $R > B$ \\
 \hline
\end{tabular}
\caption{Summary of Radio signals from Human Activity}
\label{table:human_noise}
\end{table}

The modulation used in our desired target signals is a factor.  Digital modes can operate at lower SNRs than analog SSB.  Digital modes can also use Forward Error Correction (FEC), e.g. we can correct a bit error caused by a noise impulse wiping out one bit.  Digital modulation also has a threshold effect - once the interference is a few dB lower than the wanted signals, it's impact on bit errors is small. FM, FSK \& PSK are more robust to impulsive noise than amplitude modulated modes like SSB.  However digital modes (just like analog) can't penetrate high AWGN noise levels.

\section{EMI from Pulse Trains}
\label{pwm}

\subsection{Pulse Width Modulation}
\label{smps}

The PWM switch mode power supply is a ubiquitous source of interference.  Consider the Fourier Series of an ideal pulse train \cite{wikipedia_pulse}:
\begin{equation} \label{eq_pwm}
\begin{split}
x(t) &= Ad+\frac{2A}{\pi} \sum_{n=1}^{\infty} \frac{sin(\pi n d)}{n}cos(n \omega t) \\
     &= Ad+\frac{2A}{\pi} \sum_{n=1}^{\infty} \frac{x(t)}{n} cos(n \omega t)
\end{split}
\end{equation}
where $0<d<1$ is the duty cycle and $\omega=2 \pi R$ the fundamental frequency.  The Fourier series is a sequence of harmonics $cos(n \omega t)$, with the amplitude of each harmonic set by the $x(t)/n$ term. A typical value for $R$ is a few kHz to several hundred kHz. For example with R = 70kHz and $n=101$ we will have a harmonic at 7.1 MHz. The $1/n$ factor means the power of each harmonic falls off slowly with frequency, e.g. the $n=100$ harmonic will be just $10log_{10}(1/100)=-20$ dB down compared to the fundamental ($n=1$) power, and the $n=101$ harmonic almost the same power at $10log_{10}(1/101)=-20.043$ dB down.

If the duty cycle $d$ is constant, then each harmonic is an unmodulated sine wave of constant amplitude. In practice $d$ is time varying, as the duty cycle is continuously adjusted by the power supply.  This leads to modulation of each harmonic $x(t)$, spreading the power to frequencies either side of the harmonic centre $n \omega$.

Let $d$ have a constant and time varying component:
\begin{equation}
d=d_c+ad(t)
\end{equation}
where $d(t)$, $|d(t)| \le 1$ is a PWM modulation function and $a$ is the peak amplitude of the modulation (ie the peak jitter of the PWM signal). For the $n$-th harmonic:
\begin{equation} \label{eq:pwm_n}
\begin{split}
x_n(t) &= sin(\pi n d) \\
       &= sin(\pi n (d_c+ad(t)) \\
       &= sin(\pi n d_c + \pi n a d(t)) \\
       &= sin(\pi n d_c + h d(t))  \\
     h &= \pi n a
\end{split}
\end{equation}
It can be seen that $h$ is strong function of $a$, as small changes are multiplied by $n \pi$. For example for $n=100, a=0.01, h = \pi$.  Thus with just 1\% jitter of the PWM signal, a cycle of $d(t)$ would modulate over the entire $\pm \pi$ range of the $sin()$ function.

We would like to estimate the spectrum of $x(t)$. First we consider small $h << 1$:
\begin{equation} \label{eq:small_h}
\begin{split}
x_n(t) &= sin(\pi n d_c)cos(hd(t)) + cos(\pi n d_c)sin(hd(t)) \\
       &\approx sin(\pi n d_c)(1 - (hd(t))^2/2) + cos(\pi n d_c)hd(t) \\
       &\approx sin(\pi n d_c) + hcos(\pi n d_c)d(t)
\end{split}
\end{equation}
The LHS is a constant term related to the mean duty cycle of the PWM signal, the RHS is linear modulation term, i.e. a small linear modulation about a mean set point.  When multiplied by the $n$-th harmonic $cos(n \omega t)$ in (\ref{eq_pwm}):
\begin{equation}
\begin{split} \label{eq:small_h2}
x_n(t)cos(n \omega t) &= \left[ sin(\pi n d_c) + hcos(\pi n d_c)d(t) \right] cos(n \omega t) \\
                      &= sin(\pi n d_c)cos(n \omega t)) + hcos(\pi n d_c)d(t)cos(n \omega t) \\
                      &= c_1 cos(n \omega t)) + c_2 d(t)cos(n \omega t) \\
                   c_1 &= sin(\pi n d_c) \\
                   c_2 &= hcos(\pi n d_c)
\end{split}
\end{equation}
By examining the different frequency terms we can estimate the spectrum of the PWM signal near the n-th harmonic. Note $c_1$ and $c_2$ are constants that do not affect the number of different frequency terms. The LHS of (\ref{eq:small_h2}) is a constant carrier term at the harmonic centre. The product of $d(t)cos(n \omega t))$ will produce images of the spectra of d(t) either side of $n \omega$. Thus (\ref{eq:small_h2}) is Amplitude Modulated (AM) signal.  For example if $d(t)$ is a random variable with maximum frequency $\omega_m$ radians, we would see a uniform noise spectrum over the interval $n \omega \pm \omega_m$, with a central "carrier" spectral line at $n \omega$. If $\omega_m > \omega/2$, the entire region between each harmonic will have additive white noise generated from the PWM signal.

For larger $h$, Equation \ref{eq:pwm_n} can be interpreted as Phase Modulation (PM) \cite{wikipedia_phase} of a zero frequency carrier. Assuming a random $d(t)$, the resulting spectra of $x(t)$ can be approximated using Carsons Rule, as having 98\% of it's power contained within $B_c=2(h+1)f_m$ Hz, where $f_m$ is the maximum frequency component of $d(t)$. When multiplied by the $cos(n \omega t)$ term, the PM signal will spread the power of the carrier over range of adjacent frequencies, replacing the PWM carrier in the small $h$ case with a wideband signal.

For example, let $a=0.02$ (a few percent jitter of the PWM duty cycle) and the bandwidth of the PWM control loop be $f_m=3$ kHz. At $n=100$ we have $h=\pi n a = 2\pi$, which implies a random deviation of $\pm 2\pi$ (two cycles of $sin()$), and an $x(t)$ bandwidth of $B_c=2(2 \pi+1)f_m = (4\pi+2)f_m = 43$ kHz.

\subsection{Discussion}

\begin{enumerate}
\item Given $h$ increases with $n$, we can expect to see AM type modulation either side of central harmonics lines at lower frequencies.  At intermediate frequencies a raised noise floor will be observed between harmonics.  As the frequency increases further the power of the harmonics lines will reduce and gradually be replaced by broadband noise.
\item With the common scenario of a receiver of bandwidth $B<R$, we would encounter sine wave "carriers" every R kHz as we tune.  Tuning between carriers would expect to hear a bandpass version of $d(t)$, this may or may not be white.  If not white, it may have structure we can exploit.
\item With a large number of PWM sources, the central limit theorem suggests the sum will converge to AWGN noise with very little structure in time or frequency.  This may the case with signals radiated from electricity power lines that are coupled to thousands of switch mode power supplies in a city.
\item In the local case, it is possible that switch mode PWM or impulse noise may dominate a particular receiving station.
\end{enumerate}

\subsection{Periodic Impulse Noise}

Section \ref{smps} explored the spectra of PWM power supplies which typically have a pulse rate $R$ greater than the receiver bandwidth $B$ (e.g. $B=2000$Hz for SSB signals on HF radio). A low frequency pulse train (such as ignition or $R=50 \ldots 60$ Hz impulses from domestic lighting) can also be interpreted as a pulse train with small duty cycle $d$, and $R<<B$.  In this case there will be a number of harmonics inside our receiver passband.  Consider (\ref{eq_pwm}), band pass filtered such that only harmonics $n_1 \ldots n_2$ remain:
\begin{equation}
\begin{split}
x(t) &= Ad+Ad\sum_{n=1}^{\infty} sinc(\pi n d) cos(n \omega t) \\
BPF \left[ x(t) \right] &= Ad\sum_{n=n_1}^{n=n_2} sinc(\pi n d) cos(n \omega t)
\end{split}
\end{equation}
Shifting down to baseband, and making the substitution $k=n-n_1$:
\begin{equation}
\begin{split}
BPF \left[ x(t) \right] cos(n_1 \omega t) &= \frac{Ad}{2} \sum_{k=0}^{n=n_2-n_1} sinc(\pi (k+n_1) d) cos(k \omega t) \\
&+ \frac{Ad}{2} \sum_{k=0}^{n=n_2-n_1} sinc(\pi (k+n_1) d) cos((k+n_1) \omega t) \\
&= b(t) + c(t)
\end{split}
\end{equation}
By applying a low pass filter we are left with the baseband term $b(t)$:
\begin{equation}
\begin{split}
b(t) &= \frac{Ad}{2} \sum_{k=0}^{n=n_2-n_1} sinc(\pi (k+n_1) d) cos(k \omega t) \\
     &= \frac{Ad}{2} + \frac{Ad}{2} \sum_{k=1}^{n=n_2-n_1} sinc(\pi n_1 d + \pi k d) cos(k \omega t)
\end{split}
\end{equation}
This expression is similar to the Fourier Series for a pulse train (\ref{eq_pwm}), but limited to $n_2-n_1$ harmonics by the bandwidth $B$ of the receiver.  The baseband signal $b(t)$ can therefore be interpreted as a periodic signal with the same period $\omega$ as the wideband periodic impulse noise $x(t)$.  The shape of the pulse train will be a modified version of the $x(t)$, as we are using a band pass set of $sinc()$ coefficients.  Given the duty cycle $d$ is likely to be small (e.g a $10 \mu$s pulse every 20ms), and $n_2-n_1 << n_1$, the coefficients are likely to be similar in amplitude across $n_1 \ldots n_2$, producing a high peak to average power (low duty cycle) ratio pulse train.

Given $d$ is small, and there is still significant power at high harmonic numbers, $A$ must be very large for these impulse noise sources.

\subsection{PWM Attacks}

\begin{enumerate}
\item Estimation and subtraction of the signals. Key take away is mirror of $d(t)$ about harmonic centre.  We could use estimation of the signal from one sideband to cancel other sideband. This will be problematic when it's spread so far that we get energy from $n+1$, $n-1$ near harmonic $n$.  However in that case it may not be as annoying/strong.

\item Estimation of signal from adjacent harmonics.  Can we find $x_n(t)$ from $x_{n-1}(t)$?  $\omega$ and $n$ can be estimated from the spectrum (note $\omega$ and $d$ are likely to be time varying). A direct form solution is unlikely however the equations are differentiable so an iterative solution could be found.  It would be easier to estimate the parameters at lower frequencies as the modulation index $h$ will be smaller.  It could then be synthesised for any other band of frequencies. 

\item Dual channel coherent removal (diversity receiver).

\item Noise blanking in the time domain.  This may be challenging with $R>100$ kHz, as the period becomes $< 10\mu$s, implying the need for a wide bandwidth and sample rate $>>100$ kHz in order to resolve individual noise pulses in the time domain.

\item Training of time domain pulses, correlation and removal.

\item Wide bandwidth noise blanker, such that a pulse of a few $\mu$ in a 30 kHz period can be removed.

\end{enumerate}

\section{Noise Blanker}
\label{blanker}

Consider a signal $x(t)$ consisting of a wanted sinusoidal signal and an unwanted impulse train that repeats every $1/R$ seconds.
\begin{equation}
x(t) = a_1 e^{j \omega_1 t} + a_{imp}\sum_{n=-\infty}^{\infty}\delta(t-n/R)
\end{equation}
To remove the impulse, a blanking pulse train $b(t)$ is applied.  Each pulse is $T$ seconds wide:
\begin{equation}
\begin{split}
b(t) &= 1 - p(t) \\
p(t) &= \sum_{n=-\infty}^{\infty}rect(t-n/R) \\
rect(t) &= 
	\begin{cases}
      1, & |t| <= T/2 \\
      0, & otherwise \\
	\end{cases} \\
\end{split}
\end{equation} 
The blanking pulse train removes the impulse pulse train such that:
\begin{equation}
\sum_{n=-\infty}^{\infty}\delta(t-n/R) b(t) = 0
\end{equation}
\begin{figure}[h]
\caption{Blanking Pulse $b(t)$ }
\vspace{5mm}
\label{fig:rect_time}
\centering
\begin{tikzpicture}
\draw[thick,->] (1,0) -- (5,0) node [below]{t};
\draw (1,2) -- (2,2) -- (2,0) node [below]{$-T/2$} -- (4,0) node [below]{$T/2$} -- (4,2) -- (5,2);
\end{tikzpicture}
\end{figure}

The pulse train $p(t)$ can be expressed as Fourier Series (\ref{eq_pwm})
\begin{equation}
\begin{split}
p(t) &= d+\frac{2}{\pi} \sum_{n=1}^{\infty} \frac{sin(\pi n d)}{n}cos(n \alpha t) \\
     &= d + d \sum_{n=1}^{\infty} sinc(\pi n d) \left[ e^{-j\alpha n t} + e^{j \alpha n t} \right] \\
     &= d + d h(t) \\
h(t) &= \sum_{n=1}^{\infty} sinc(\pi n d) \left[ e^{-j\alpha n t} + e^{j \alpha n t} \right]  
\end{split}
\end{equation}
where $\alpha=2 \pi R$ is the angular frequency of the pulse train, $d=TR$ is the duty cycle, and $h(t)$ is the RHS term containing the harmonics.  The Fourier Transform of $h(t)$ is:
\begin{equation}
\begin{split}
H(w) &= \int_{-\infty}^{\infty}h(t)e^{-j \omega t}dt \\
     &= \int_{-\infty}^{\infty} \sum_{n=1}^{\infty} sinc(\pi n d) e^{-j\alpha n t}e^{-j \omega t}dt \\
     &+ \int_{-\infty}^{\infty} \sum_{n=1}^{\infty} sinc(\pi n d) e^{j\alpha n t}e^{-j \omega t}dt \\
     &= \sum_{n=1}^{\infty} sinc(\pi n d) \left[ \delta(\omega + \alpha n) + \delta(\omega - \alpha n) \right]
\end{split}
\end{equation}
The frequency shifted Fourier transform of $h(t)e^{j \omega_1 t}$ is
\begin{equation}
\begin{split}
\int_{-\infty}^{\infty} h(t)e^{j \omega_1 t} e^{-j \omega t}dt &= H(\omega-\omega_1) \\
  &= \sum_{n=1}^{\infty} sinc(\pi n d) \left[ \delta(\omega + \alpha n - \omega_1) + \delta(\omega - \alpha n - \omega_1) \right]
\end{split}
\end{equation}

Consider the output of the noise blanker:

\begin{equation}
\begin{split}
y(t) &= x(t)b(t) \\
     &= a_1 e^{j \omega_1 t} - a_1 e^{j \omega_1 t}p(t) \\
     &= a_1 e^{j \omega_1 t} - a_1 e^{j \omega_1 t}(d + dh(t)) \\    
     &= a_1 (1-d) e^{j \omega_1 t} - a_1 d h(t) e^{j \omega_1 t} \\    
Y(w) &= a_1 (1-d) \delta(\omega - \omega_1) - a_1 d H(\omega-\omega_1) \\
     &= a_1 (1-d) \delta(\omega - \omega_1) \\
     &- a_1 d \sum_{n=1}^{\infty} sinc(\pi n d) \left[ \delta(\omega + \alpha n - \omega_1) + \delta(\omega - \alpha n - \omega_1) \right]
\end{split}
\end{equation} 

\begin{figure}[h]
\caption{Two examples of Noise Blanker output spectrum $|Y(f)|$.  The green lines show a sample SSB radio bandwidth of $B=3000$ Hz. Top is pulse rate $R<B$, bottom with $R>B$.  Note the harmonic level increasing with duty cycle $d=TR$, and how the harmonics fall outside of $B$ on the bottom plot. }
\label{fig:blanker}
\begin{center}
\input blanker.tex
\end{center}
\end{figure}

\subsection{Discussion}
\label{blanker_discussion}

\begin{enumerate}
\item The wanted signal amplitude has been reduced to $(1-d)$, and harmonics $H(\omega)$ have been introduced either side.  These are spectral copies of the input signal, spaced every $\alpha$ radians/s.
\item An attenuation of $(1-d)$ is quite modest, for example if half of the signal is blanked ($d=0.5$), we lose just 3dB of the wanted signal power.  So quite heavy blanking is feasible, if it improves the output SNR by removing the noise pulse.
\item The harmonic levels are proportional to the duty cycle $d$.  As our blanking pulse becomes longer relative to the noise period, we will experience more blanking noise.
\item If the harmonic levels approach $a_1$ they may cause interference.  However for digital waveforms a margin of only a few dB beneath the wanted signal would be acceptable.  This suggests digital waveforms can benefit more from noise blanking than analog. 
\item A second, strong signal in the passband could introduce interference if one of it's harmonic sidebands approaches $a_1$ at $\omega_1$.  This is the intermodulation effect of noise blankers.
\item The PWM analysis in Section \ref{pwm} showed that a small duty cycle/small jitter signal can cause broadband noise.  This suggests a narrow time domain blanking pulse $T<<1/R$ can remove that noise with acceptable impact on the wanted signal. 
\item With noise/blanker pulse rates $R>B$, the harmonics are separated by $R$, so blanker harmonics are likely to be outside of our target pass band $B$.  However intermodulation effects are larger, so strong signals further away could be aliased into our passband. 
\item So far a rectangular blanking pulse has been assumed. A smoother function for $p(t)$ is likely to reduce the level of $H(\omega)$. 
\end{enumerate}

\section{Antenna Systems}

Noise signals can be induced in antenna systems and hence receivers by injection of common mode currents into feed lines. We should take steps to reduce coupling by using routing feed lines away from EMI sources such as household wiring.  The injection of common mode feed line currents into our receiver can be reduced by using balanced antenna systems (e.g. a balun on your dipole) and common mode chokes. A preamplifier located at the feedpoint may increase the ratio of wanted Rx signal to common mode feedline noise, depending on how the common mode signal is coupled into the antenna system. 

Physical distancing of the antenna elements from noise sources will help reduce near field coupling due to the strong inverse relationship between near field strength and distance.  A separation of greater than $\lambda/10$ or 6m from homes and street wiring is recommended by \cite{lz1aq}\cite{wellbrook}\cite{w8ji_radio_noise}.  However even 6m can be problematic on small urban blocks.  Increased antenna height can help increase physical separation, if permitted by local government regulations.

\subsection{Diversity}

\begin{figure}[h]
\caption{Diversity noise cancellation model}
\label{fig:diveristy_model}
\begin{center}
\begin{tikzpicture}
\draw [->] (1,2) -- (3,2);
\draw [->] (1,2) -- (2.1,0.4);

\node[] at (0.6,2) {$e(t)$};
\node[] at (3.5,2) {$r_1(t)$};
\node[] at (2.5,0.25) {$r_2(t)$};
\node[] at (2.0,2.25) {$a_1$};
\node[] at (2.0,1.1) {$a_2$};
\end{tikzpicture}
\end{center}
\end{figure}

Consider Figure \ref{fig:diveristy_model} where an EMI signal $e(t)$ received on two antennas:
\begin{equation}
\begin{split}
r_1(t) &= a_1 e(t) \\
r_2(t) &= a_2 e(t) \\
\end{split}
\end{equation}
where $a_1$ and $a_2$ are complex constants that model path loss and phase shift due to propagation delay. It can be shown that:
\begin{equation} \label{eq_diversity1}
r_1(t) = cr_2(t)
\end{equation}
where $c=a_1/a_2$, the ratio of two complex gains.  Thus if we can estimate $c$, we can use (\ref{eq_diversity1}) to estimate and remove the EMI $r_1(t)$ received on antenna 1. To satisfy (\ref{eq_diversity1}), we need to choose $c$ to minimise the cost function:
\begin{equation} 
E = r_1(t) - cr_2(t)
\end{equation}

Consider a poorly filtered switch mode power supply $e(t)$ inside a house that is coupled by the house wiring into a nearby antenna.  The house wiring is routed near the antenna at several points, resulting in multiple coupling paths, each with different path loss and delay. The signal collected by the antenna can be modelled as the sum of the signals from multiple different paths:
\begin{equation}
\begin{split}
r_{local}(t) &= \sum_n a_n e(t) \\
     &= \left( \sum_n a_n \right) e(t) \\
     &= a e(t)
\end{split}
\end{equation}
Note the vector sum of many paths resolves to single complex constant.  This will be true of each antenna placed near the house, so (\ref{eq_diversity1}) can be satisfied, and the noise removed. Noise from overhead electricity lines could be modelled the same way - a single noise signal radiated by many different antennas.

Consider the case where the there are several independent noise sources located at different locations, e.g. an urban location in the middle of a city:
\begin{equation}
r_{urban}(t) = \sum_n a_n e_n(t)
\end{equation}
It is unlikely the phase and amplitude relationships described by $a_n$ will be the same for each source so the solution of (\ref{eq_diversity1}) will be different for each source.  If we rely on a single coefficient, cancellation will be ineffective.  So the effectiveness of diversity will rely on how well the noise resolves to a single source.

Diversity is unlikely to be effective in cancelling urban noise, but will be effective for single local noise sources, even if coupled from multiple paths (like noisy overhead electricity lines surrounding an antenna).

In terms of antenna pattern, the two antennas form a phased array.  Diversity can be viewed as $e(n)$ resolving to the equivalent of a point source, where we place a null in the antenna pattern.  In the case of multiple coupling paths (like house wiring coupling to an antenna), the "bearing" of the null may not have a meaningful physical interpretation.

This model requires the EMI signal to be present (i.e. above the receiver internal noise) in both received signals. In diversity systems the two antennas are placed some fraction of a wavelength apart. Near field intensity is a strong function of distances of less than one wavelength, so the two antennas are likely to have very different responses to near field EMI. For example at a spacing of $\lambda/4$ a near field signal coupled to one antenna may be undetectable in the other antenna. This implies the effectiveness of diversity will be sensitive to antenna placement.

\subsection{Directional Antennas}

Consider a 100\% efficient isotropic antenna that receives power equally from all directions.  The gain pattern can be visualised as a sphere of constant radius, with a solid angle of $4 \pi$ steradians. Now consider an ideal directional antenna with a cone shaped pattern that receives all it's power from a solid angle of $\theta$ steradians, and no power from any other angle.  It's power gain is $G=\frac{4 \pi}{\theta}$. 

If the EMI is the sum of many sources it is likely to have equal power flux density in all directions.  Consider an isotropic antenna placed at the centre of this field. If the total noise power received from an isotropic antenna is $N$ watts, the noise power in a solid angle of $\theta$ radians is $N \frac{\theta}{4 \pi}$ Watts, so the noise power at the directional antenna terminals is:
\begin{equation}
\begin{split}
 P &= N \frac{\theta}{4 \pi} G \\
   &= N \frac{\theta}{4 \pi} \frac{4 \pi}{\theta} \\
   &= N
\end{split}
\end{equation}
Thus the noise power received by a directional antenna is the same as an isotropic antenna and the same in any direction. In contrast our far field wanted signal is a point source. If that signal develops a power of $S$ watts into an isotropic antenna, it will develop a power of $GS$ watts at the terminals of our directional antenna. The S/N improvement using a directional antenna in a uniform EMI field is therefore improved by the antenna gain $G$.  

For lower HF where external (ambient) noise dominates, directivity \cite{w8ji_directivity} is more important than gain.  Directivity is the ratio of power received from our wanted direction compared to power from all other directions. Merely improving gain (without changing directivity) will not improve SNR in the presence of isotropic noise, as both signal and noise will increase.  It also implies low gain (but directional) antennas such as arrays of small dipoles or loops, can improve received SNR.

If the EMI is a point source, we may be able to place it in a pattern null using a directional antenna or diversity/beamforming techniques, further improving the effectiveness of the attack.

\subsection{Topology}

Antenna topologies may help reduce near field coupling.  For example the conductors of physically small loops and dipoles can be placed further away from near field sources compared to a full length dipole that must extend across the entire width of an urban block \cite{lz1aq}.

There are many subjective reports that small loop antennas (either tuned or untuned) provide significant reductions in EMI, by virtue of lower sensitivity to near electric fields.  However loop antennas are not magic \cite{w8ji_radio_noise}, and perform worse than dipoles in the presence of strong magnetic fields and even at certain distances from electric fields.  The principle benefit appears to be small overall dimensions, making them easier to position away from near fields radiating from homes and power lines. In installations with a rotator, the ability to null point noise sources is also useful.

There are subjective reports from the on-line community that a loop antenna placed in or even under the ground \cite{k5jy_log}\cite{duffy_lig} performs favourably in suburban locations compared to traditional antennas such as dipoles. It is a balanced design, and the use of common mode chokes on either end of the feedline is recommended. The low gain (e.g. -30 dB) is usable for Rx operation as noise external to the receiver generally dominates system noise figure at HF. So both signal and noise is reduced, and S/N remains the same.

The physics around how this antenna can reduce the effects of EMI is unclear. It is possible that compared to a reference dipole, near field noise is reduced as it is attenuated more than desired far field signals by the low (or subterranean) placement of the antenna.  It's low placement and novel use of urban grassed areas may also increase physical distance to near field signals such as overhead power lines and nearby houses.

The cobweb antenna is a dipole that has been arranged into a square such that the two ends nearly touch.  This creates a compact shape (3 metre sides on the 20M band) that allows it to be more easily physically distanced from near field sources (e.g. vertically on a mast) than a traditional linear dipole.  In particular this arrangement keeps the high impedance "ends" of the dipole that are most sensitive to electric field noise further away from the ground and near field sources than an traditional inverted V. The folding results in a few dB less gain than a dipole, however given the omnidirectional pattern and dominance of ambient noise at HF that may have limited effect on SNR.

It seems likely that in the absence of significant directivity, antenna topology alone cannot distinguish urban EMI (such as AWGN noise that is the sum of many noise sources in a city) from wanted signals.

\section{Experimental Measurements 1}

In May 2023 I performed some measurements at my suburban home.  The goal was to gain experience in measuring EMI and attempt to fit experimental results to the theoretical framework above.

The home is located in Adelaide (population 1.3 million), South Australia and is on a suburban square corner block of 550 \si{\metre\squared}.  Overhead power lines are on two sides, and the suburb is served by VDSL Internet using overhead 70 year old phone lines.  There are two adjacent houses, and the home and it's Southern neighbour have roof mounted solar PV systems.

Figure \ref{fig:home_map} is a map of my home. The station antenna is an inverted V fan dipole with 40m and 20m elements, suspended over the house (and solar panels), the mast and feed point is 9m above ground. It is coupled to 50 ohm coax using a balun at the feedpoint. Subjectively, SSB stations on the 40m band are hard to hear and unpleasant to listen to, and 20m varies between reasonable noise levels and completely unusable (time varying).

\begin{figure}[h]
\caption{Map of my home.  EMI sources are overhead power and xDSL lines, wiring in the home and adjacent homes, and roof mounted solar PV systems on my home and the home to the South.}
\label{fig:home_map}
\begin{center}
\includegraphics[width=12cm]{house_map.png}
\end{center}
\end{figure}

\subsection{Observations}

\begin{figure}[h]
\caption{Experimental set up for measurements}
\label{fig:meas_config_1}
\begin{center}
\begin{tikzpicture}
\draw (1.5,3) -- (2.5,3) -- (2,2.5) -- (1.5,3);
\draw (2,2.5) -- (2,2);
\draw (2,2) -- (4,2);
\draw (4,1.5) rectangle (5,2.5);
\draw (4,1.5) -- (5,2.5);
\draw (4,2.5) -- (5,1.5);
\draw (5,2) -- (6,2);
\draw (6,1.5) rectangle (8,2.5);
\draw (4.5,1.5) -- (4.5,0.5);
\draw (4.5,0.5) -- (6,0.5);
\draw (6,0) rectangle (8,1);

\node[align=center] at (7,2) {Spec-an};
\node[align=center] at (7,0.5) {Receiver};
\end{tikzpicture}
\end{center}
\end{figure}

Figure \ref{fig:meas_config_1} shows the experimental configuration. The inverted V dipole was connected via a 3dB splitter to a Rigol DSA 815 spectrum analyser, and the noise power measured at 7.1 and 14.2 MHz.  The spec-an settings were: 3kHz resolution bandwidth, span 200 kHz, pre-amp on, attenuator 0dB, RMS detector, power averaged over 100 counts.  The noise floor of the spec-an is about -160 dBm/Hz. The other port of the splitter was connected to an IC7300 HF radio to monitor the signal.

\begin{figure}[h]
\caption{Scatter plot of noise power measurements over a period of 1 week, made in a 3 kHz resolution bandwidth (top), and converted to a 1 Hz bandwidth at bottom.  Red circles indicate clusters.}
\label{fig:noise_measurements}
\begin{center}
\input measurement.tex
\end{center}
\end{figure}

Figure \ref{fig:noise_measurements} plots noise power measurements made over a period of one week (1-3 measurements each day) in May 2023 on the 40M and 20M bands.  There were three clusters (Table \ref{table:measurement_clusters}), that were used as a first step in characterising the noise. Each cluster was allocated a label (noise A, B \& C). The ambient noise figure is given by $F_a = N_0 - 174$. Table \ref{table:external_noise_figure} compares the measurements to the median $F_a$ for residential locations from ITU-R P.372-16 \cite{itu372-16}. The measurements have been adjusted for the splitter (-3.5dB) and feedline (-1dB) losses.  The noise field is assumed to be isotropic so the antenna gain is modelled as 0dB. The measured noise power is consistent my previous efforts using a small tuned loop \cite{rowetel_noise_city}.

Fitting a straight line to the S-unit standard calibration of S9 = -73dBm, and 6dB per S-unit we can find S units from received power $R$ in dBm:
\begin{equation}
S = R/6 + 21.17
\end{equation}
If we assume the receiver sums noise power in a 2000 Hz bandwidth:
\begin{equation} \label{eq:s_unit}
\begin{split}
S &= \frac{N_0+10log_{10}(2000)}{6} + 21.17 \\
S &= N_0/6 + 26.7
\end{split}
\end{equation}
The S units are not sensitive to filter bandwidth, e.g. for a 3000Hz bandwidth $S = N_0/6 + 27$.
\begin{table}[h]
\centering
\begin{tabular}{l c c c c}
 \hline
 Label & Freq (MHz) & $N_0$ (dBm/Hz) & $F_a$ Meas (dB) & S-unit \\
 \hline
 A & 7.1  & -121 & 53 & S6.5 \\
 B & 14.2 & -139 & 35 & S3.6 \\
 C & 14.2 & -125 & 52 & S6.4 \\
\end{tabular}
\caption{Noise sources and equivalent External Noise Figure $F_a$ and S-units.}
\label{table:measurement_clusters}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{l c c c}
 \hline
 Label & Freq (MHz) & $F_a$ P.372 (dB) & $F_a$ Meas (dB) \\
 \hline
 A & 7.1  & 49 & 53 \\
 B & 14.2 & 41 & 35 \\
 C & 14.2 & 41 & 52 \\
\end{tabular}
\caption{Median P.372-16 Residential External Noise Figure $F_a$ compared to measurements.}
\label{table:external_noise_figure}
\end{table}

\subsection{Discussion}

\begin{enumerate}
\item The IC7300 S-meter was found to be uncalibrated \cite{vu2nsb_s_meter} (6dB power change not equal to one S unit) and could not be relied upon to measure noise power.  Instead, the S-units in Table \ref{table:measurement_clusters} where calculated using equation (\ref{eq:s_unit}). However the IC7300 waterfall is quite useful as a single plot shows both $R<B$ impulse noise (lines across all frequencies) and $R>B$ PWM (harmonics spaced at $R$ Hz).
\item The site has strong 50 Hz impulse noise however the IC7300 noise blanker removes this quite effectively, especially on 7.1 MHz.  The zero span feature of the spec-an (set to 100ms sweep time) is useful for observing these short impulses - it turns the spec-an into a tuned oscilloscope with adjustable centre frequency and bandwidth.  A sweep time of 100ms and resolution bandwidth of 30 kHz was useful for observing 10ms period pulses typical of 50 Hz impulses (one per edge).
\item Noise A/B appeared to be mainly AWGN, although at times PWM harmonics could be observed on both bands. The presence of the harmonics had no affect on the observed noise power between the harmonics, which suggests a small modulation index $h$.
\item The 14.2 high level noise C corresponded to wideband noise with quite wide harmonics about 30kHz apart just visible on the waterfall.  From our PWM analysis in Section \ref{pwm}, this suggests $R>B$ with a fairly high modulation index $h$.  The time varying power between B and C could be due to shifts in the mean PWM duty cycle $d$, leading to shifts in the $sin(\pi n d)$ Fourier coefficients across the observed band.  Given $n$ is so high, even small shifts in $d$ can cause large changes in the amplitudes of the Fourier components.
\item A 500MHz bandwidth oscilloscope with a 50 ohm input was connected instead of the spec-an but was not found to be very useful; nearby AM broadcast stations tend to dominate the wideband time domain signal.  Fitting a 7MHz high pass filter fixed this problem and made the oscilloscope more useful (see below). 
\end{enumerate}

\subsection{Diversity Receiver}

A set of experiments was conducted with the Linrad application \cite{linrad_home} configured to use an Afedri AFE822x Dual channel SDR \cite{afedri_dual}.  The second antenna was a portable end-fed dipole erected in the front of the property, about 10m from the inverted V dipole, sloping from 7m down to 2m.

Due to strong AM broadcast signals beneath 2 MHz, the AFE822x gain had to be reduced to avoid clipping, raising the noise floor of the receiver, and limiting the amount of diversity cancellation possible. The signals from both antennas were often quite different.  This suggests signals local to each antenna such as near field EMI, or feed line pick up.

Using the Linrad phasing feature \cite{linrad_phasing} it was possible to suppress signals that were common to both receivers, for example strong PWM harmonics.  When tuned to segments of the "noise floor", suppression was not possible, which suggests the noise signals being received by both receivers were different.

An experiment was conducted where the signal from one antenna was split, and fed into each receiver.  In this case, the noise could be suppressed by Linrad, demonstrating that if the noise in both receivers satisfies (\ref{eq_diversity1}), it can be cancelled.

\subsection{Conclusions}

\begin{enumerate}
\item Noise A \& B are close to P.372, AWGN, and cannot be reduced further with diversity.  This suggests far field noise from the surrounding city (many sources, many directions), which means I'm doing as well as expected (perhaps a little better than the median at 14.2 MHz).  Turns out I'm normal after all!  Experimentation with antennas is one of the few options to improve the SNR of signals I receive at my site. 
\item Noise C on 14.2 MHz looks like time varying local PWM noise, and needs further investigation.
\end{enumerate}

\section{Experimental Measurements 2}

\subsection{Loop Antenna}

Am I suffering from near field noise? I have Wellbrook ALA1530LN Loop Antenna, so I placing it on a tripod at various sites around my block, and measured the received power in a 3kHz bandwidth. The gain of the Wellbook is different to the dipole, so the powers cannot be directly compared.  Figure \ref{fig:home_map_loop} shows the noise power.  It peaks in the area closest to several homes, and drops off when equidistant from my home and electricity lines.  The Wellbrook manual suggests placement 6m from buildings and other noise sources - good advice!

I'm not nerdy enough to leave it set up in the middle of the front yard, so settled for the "X" position where its obscured by a tree.

\begin{figure}[h]
\caption{Map of noise power at 14.2 MHz (dBm in 3 kHz) measured around my home on the Wellbrook.}
\label{fig:home_map_loop}
\begin{center}
\includegraphics[width=12cm]{house_map_loop.png}
\end{center}
\end{figure}

When receiving off air signals, the subjective SNR from the Wellbrook is roughly the same as the dipole on 40m and 20m.  Sometimes one sounds better, sometimes the other, as would be expected from different patterns and polarisation.  Listening tests are confused by the different levels from the antennas, the dipole is "louder" (both signal and noise increase) than the Wellbrook on 40m, and the opposite on 20m.  So when I flip the antenna switch, the signal and noise I hear leaps up or down while the AGC adjusts.

\subsection{Observations}

I used a more elaborate setup for my next set of observations (Figure \ref{fig:meas_config_2}).  With the addition of the 7 MHz HPF I found the scope much more useful, especially for identifying impulse noise.  Impulse noise viewed on the scope is much more obvious using the Wellbrook, presumably due to it's wide bandwidth. Note impulse noise may sound the same on the SSB receiver with either antenna (same raspy, buzzing sound), it's just harder to observe when the dipole is connected to the scope. Switching between the loop and dipole allows me to see if the noise signal is present in both antennas, for example to determine if it's near field noise in just one of them.

So I can observe noise signals with the spec-an, oscilloscope, IC7300 (or Linrad) receiver waterfall, and by listening to the receiver audio.  I can select how I collect the noise by switching between two antennas.

\begin{figure}[h]
\caption{Experimental set up for second set of measurements.  A loop antenna, switch, and oscilloscope has been added. The 7 MHz Band Pass Filter (BPF) removes the strong broadcast signals, making the oscilloscope more useful.}
\label{fig:meas_config_2}
\begin{center}
\begin{tikzpicture}

% antenna
\draw (1,3) -- (2.0,3) -- (1.5,2.5) -- (1,3);
\draw (1.5,2.5) -- (1.5,2);
\draw (1.5,2) -- (2.5,2);

% loop antenna
\draw (1.5,0.5) circle (0.5);
\draw (2,0.5) -- (2.5,0.5);

% BPF
\draw (3,1) -- (3,1.5);
\draw (2.5,0) rectangle (3.5,1);
\node[align=center] at (3,0.5) {BPF};

% switch
\draw (2.7,1.7) -- (3.2,2) -- (4,2);

% first splitter
\draw (4,1.5) rectangle (5,2.5);
\draw (4,1.5) -- (5,2.5);
\draw (4,2.5) -- (5,1.5);
\draw (5,2) -- (5.5,2);

% second splitter
\draw (5.5,1.5) rectangle (6.5,2.5);
\draw (5.5,1.5) -- (6.5,2.5);
\draw (5.5,2.5) -- (6.5,1.5);

% Rx
\draw (4.5,1.5) -- (4.5,1);
\draw (4,0) rectangle (5,1);
\node[align=center] at (4.5,0.5) {Rx};

% spec-an
\draw (6.5,2) -- (7,2);
\draw (7,1.5) rectangle (9,2.5);
\node[align=center] at (8,2) {Spec-an};

% scope
\draw (6,1.5) -- (6,0.5);
\draw (6,0.5) -- (7,0.5);
\draw (7,0) rectangle (9,1);
\node[align=center] at (8,0.5) {Scope};

\end{tikzpicture}
\end{center}
\end{figure}

\subsection{Noise D}

Shortly after setting up the new measurement system, an additional impulse noise source D was discovered.  I can hear it equally well on the radio using either antenna (as a buzzy noise), although it is somewhat more obvious on the scope using the Wellbrook.  The IC7300 noise blanker is not effective unless "delay" is set to 100\%, however this setting results in weak SSB signals being distorted. It's power (measured into the dipole) varies -110 and -100 dBm/Hz (between clusters B \& C), but has no obvious harmonic structure. On several days I have observed it in the morning for a few hours, disappearing by about 10am.

Observing the oscilloscope at various time bases is instructive (Figures \ref{fig:D_dipole_10ms}, \ref{fig:D_dipole_2us} and \ref{fig:D_dipole_50ns}).  This shows complex pattern of impulses, with each impulse causing the antenna system to ring for a few $\mu$s.

Figure \ref{fig:D_wellbrook_5ms} is noise D received on the Wellbrook. Note the peak of the impulse is 150mVpp.  Taking into account 7dB of splitter loss, that's around 400mVpp from the antenna.  These are very high peak power signals, I am amazed that modern receivers can deal with 400mVpp input signals at all.

\begin{figure}[h]
\caption{Impulse noise D received on dipole at 10ms/division.  A complex sequence of impulses and bursts of impulses.  The constant amplitude component is the middle is "everything else"; the sum of many radio signals and noise.}
\label{fig:D_dipole_10ms}
\begin{center}
\includegraphics[width=8cm]{D_dipole_10ms.jpg}
\end{center}
\end{figure}

\begin{figure}[h]
\caption{Impulse noise D received on dipole at 2$\mu$s/div.  The bursts resolve into a sequence of exponentially decaying "ringing" pulses.  Each of these pulses is about 200 $\mu$s apart.}
\label{fig:D_dipole_2us}
\begin{center}
\includegraphics[width=8cm]{D_dipole_2us.jpg}
\end{center}
\end{figure}

\begin{figure}[h]
\caption{Impulse noise D received on dipole at 50ns/div.  The ringing has a period of 139ns, or a frequency of 7.19 MHz, the resonant frequency of the 40M dipole.}
\label{fig:D_dipole_50ns}
\begin{center}
\includegraphics[width=8cm]{D_dipole_50ns.jpg}
\end{center}
\end{figure}

\begin{figure}[h]
\caption{Impulse noise D on Wellbrook, 150mVpp at 5ms/div.}
\label{fig:D_wellbrook_5ms}
\begin{center}
\includegraphics[width=8cm]{D_wellbrook_5ms.jpg}
\end{center}
\end{figure}

\subsection{Discussion}

Urban noise problems are complex, I have identified 4 noise sources around my home so far.

The relatively close spacing of the noise D impulses (200$\mu$s apart over several ms) might explain why the noise blanker is struggling \cite{sm5bsz_blanker}.  The blanker signal processing is likely operating at a bandwidth such that consecutive pulses are smeared together, so the blanker would be forced to blank about 5ms out of every 20ms. From our noise blanker analysis in Section \ref{blanker_discussion} the blanker noise products are duty cycle $d$ lower than the wanted signal, or $10log10(5/20)=-6$ dB lower in power than the wanted signal.  We would expect this to be quite obvious on SSB signals.  However a signal/interferer ratio of 6dB wouldn't bother many digital modes.

A wideband noise blanker that can blank a few $\mu$s every 200 $\mu$s would be more effective, but would require a wider DSP bandwidth.  It also risks intermodulation interference from strong signals.  This is an interesting area for further work.  Diversity might help with Noise D as it is present in both antennas, indeed it's strength and 50Hz period suggests a suburban source propagated by electricity lines.  Perhaps a heat pump being run in the morning for a few hours.

The period of noise D is approximately the same as one PSK symbol at HF.  For the demodulation of constant envelope digital signals like (Q)PSK and FSK, these impulses could be removed by limiting.  However in the common scenario of a SSB receiver followed by DSP operating at audio bandwidths, short ($d<<B$) noise pulses would be smeared in time, reduced in amplitude and difficult to remove.  This suggests a PSK demodulator operating on a bandwidth of several hundred kHz (rather than a few kHz from a SSB receiver), coupled with limiting, would be worth exploring.

The ringing of the antenna system in response to a noise impulse suggests several attacks. We could train a system to recognise the impulse response of the antenna system to identify and remove noise impulses.  If the impulse response is known, we could inverse filter to produce very short (non smeared) noise impulses that are easy to blank.

\bibliographystyle{plain}
\bibliography{emi_refs}
\end{document}
